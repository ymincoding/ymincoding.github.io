---
layout: post
title: "[C++]Smart Pointer(μ¤λ§νΈ ν¬μΈν„°)"
description: >
    C++ λ¬Έλ²• - Smart Pointer(μ¤λ§νΈ ν¬μΈν„°) κ°λ… λ° μ‚¬μ© λ°©λ²•
author: Yunmin Cho
tags: [C++]
category: [C++]
---

μΌλ°μ μΈ ν¬μΈν„°λ” heap memoryμ— μ €μ¥λ μμ›μ— μ ‘κ·Όν•  λ• μ“°μΈλ‹¤.  
~~~c++
Rectangle* p = new Rectangle()
~~~  
μ΄λ ‡κ² μ„ μ–Έν• ν¬μΈν„°λ” λ°λ“μ‹ μμ›μ„ ν•΄μ ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤. κ·Έλ ‡μ§€ μ•μΌλ©΄ heap memoryμ—λ” `new Rectangle()`λ΅ μΈν•΄ λ©”λ¨λ¦¬κ°€ ν• λ‹Ήμ€ λμ—μΌλ‚ ν•΄μ λμ§€ μ•μ•„ λ©”λ¨λ¦¬ λ„μκ°€ λ°μƒν•λ‹¤.  
<br/>

π“__Smart Pointer(μ¤λ§νΈ ν¬μΈν„°)λ€?__  
C++μ—μ„ μ κ³µν•λ” μ¤λ§νΈ ν¬μΈν„°λ”, μλ™μΌλ΅ λ©”λ¨λ¦¬λ¥Ό κ΄€λ¦¬ν•μ—¬ ν¬μΈν„°κ°€ μ‚¬μ©λμ§€ μ•μ„ λ•μ—λ” μλ™μΌλ΅ μμ›μ„ ν•΄μ ν•΄μ£Όλ” ν¬μΈν„°μ΄λ‹¤. μΌλ° ν¬μΈν„°λ” λ…μ‹μ μΌλ΅ `delete`λ¥Ό νΈμ¶ν•μ—¬ ν•΄μ ν•΄μ£Όμ–΄μ•Ό ν•λ” λ°λ©΄, μ¤λ§νΈ ν¬μΈν„°λ” μ§€μ—­μ„ λΉ μ Έλ‚κ°€λ©΄ μλ™μΌλ΅ `deallocation`μ„ μ‹¤ν–‰ν•΄μ¤€λ‹¤.  

<br/>

~~~c++
Object* ptr = new Object(); // newλ¥Ό ν†µν•΄ λ©”λ¨λ¦¬ ν• λ‹Ήλ¨
ptr->callfunction();
// delete μ—†μ
~~~
μΌλ° ν¬μΈν„°λ¥Ό μ‚¬μ©ν•  κ²½μ°, `new`μ—°μ‚°μλ¥Ό ν†µν•΄ Object κ°μ²΄λ¥Ό μƒλ΅μ΄ λ©”λ¨λ¦¬μ— ν• λ‹Ήν•λ‹¤. ν•¨μ μ•μ—μ„ μ„μ μ½”λ“λ¥Ό μ‚¬μ©ν–κ±°λ‚, ν”„λ΅κ·Έλ¨μ΄ λλ‚¬μ„ κ²½μ° μ§€μ—­μ„ λ²—μ–΄λ‚κ² λλ©΄ μ§€μ—­ μ•μ—μ„ ν• λ‹Ήλ λ³€μμΈ ν¬μΈν„°λ” μ§€μ—­λ³€μμ΄κΈ° λ•λ¬Έμ— μ‚¬λΌμ§„λ‹¤. ν•μ§€λ§ `new`λ΅ ν• λ‹Ήλ Objectλ” deleteλ¥Ό ν†µν•΄ ν•΄μ ν•΄μ£Όμ§€ μ•μ•μΌλ―€λ΅ λ©”λ¨λ¦¬μ— λ‚¨μ•„μκ² λλ‹¤.  
__μ¤λ§νΈ ν¬μΈν„°λ¥Ό μ‚¬μ©ν•  κ²½μ°, deleteλ¥Ό λ…μ‹μ μΌλ΅ μ‚¬μ©ν•μ§€ μ•μ•„λ„ μ†λ©Έμκ°€ μ‹¤ν–‰λλ©΄μ„ μμ› ν•΄μ λ¥Ό μλ™μΌλ΅ ν•΄μ¤€λ‹¤!__  

<br/>
* * *
<br/>
π“ __Types of Smart Pointer(μ¤λ§νΈ ν¬μΈν„°μ μΆ…λ¥)__  

1. unique_ptr  
    - `unique_ptr`λ΅ ν• κ°μ²΄λ¥Ό κ°€λ¦¬ν‚¤λ©΄, ν• κ°μ²΄λ” μ¤μ§ ν• κ°μ ν¬μΈν„°λ΅λ§ μ ‘κ·Ό κ°€λ¥ν•λ‹¤. λ‹¤λ¥Έ ν¬μΈν„°μ™€ κ³µμ ν•  μ μ—†μ§€λ§, μ΄μ „μ€ κ°€λ¥ν•λ‹¤. κ·Έλ΄ κ²½μ° μ›λμ ν¬μΈν„°λ” μ‚­μ λλ‹¤.  

2. shared_ptr  
    - `unique_ptr`κ³Ό λ‹¬λ¦¬, μ—¬λ¬ ν¬μΈν„°κ°€ λ™μ‹μ— ν• κ°μ²΄λ¥Ό κ°€λ¦¬ν‚¤λ” κ²ƒμ΄ κ°€λ¥ν•λ‹¤. μ΄ λ• `shared_ptr`μ€ κ³µμ λκ³  μλ” ν¬μΈν„°μ κ°μλ¥Ό μΉ΄μ΄νΈν•λ‹¤(Reference Counter). `use_count()` ν•¨μλ¥Ό ν†µν•΄ ν™•μΈν•  μ μλ‹¤. λν• μμ‹ μ΄ μ°Έμ΅°ν•κ³  μλ” κ°μ²΄ ν•λ‚κ°€ μ†λ©Έλλ”λΌλ„, λ™μΌν• λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό κ°€λ¦¬ν‚¤λ” λ‹¤λ¥Έ shared_ptrκ°€ μμΌλ©΄ κ°μ²΄λ” μ†λ©Έλμ§€ μ•λ”λ‹¤.(dangling pointer λ°©μ§€)  

3. weak_ptr  
    - κ³µμ λκ³  μλ” ν¬μΈν„°μ κ°μ(Reference Counter)λ¥Ό μΉ΄μ΄νΈ ν•μ§€ μ•λ”λ‹¤λ” μ μ„ μ μ™Έν•λ©΄ `shared_ptr`κ³Ό κ±°μ λΉ„μ·ν•λ‹¤. shared_ptrμ κ°μ²΄λ§ μ°Έμ΅°ν•  μ μμ„ λΏ, shared_ptrμ reference counterλ¥Ό μ¬λ¦¬μ§€ μ•λ”λ‹¤.  
    - κ°™μ€ weak_ptr λλ” shared_ptrλ΅λ¶€ν„° λ³µμ‚¬ μƒμ„±, λ€μ… μ—°μ‚°μ΄ κ°€λ¥ν•κ³ , shared_ptrλ΅λ§ λ³€ν™ν•  μ μλ‹¤.  
    - νΉμ • κ°μ²΄λ¥Ό μ°Έμ΅°ν•λ©΄μ„ μλ…μ—λ” μν–¥μ„ μ£Όκ³  μ‹¶μ§€ μ•μ€ κ²½μ°, λ™μ‹μ— dangling pointerλ¥Ό λ§‰κ³ μ‹¶μ€ κ²½μ°  

4. auto_ptr
    - μ°Έμ΅°ν•κ³  μλ” λ€μƒμ— λ€ν•΄ μ†λ©Έμκ°€ μλ™μΌλ΅ delete ν•΄μ£Όλ” ν¬μΈν„°λ΅, dangling pointerλ¥Ό λ§‰λ”λ‹¤.  
    - `auto_ptr`μ„ λ³µμ‚¬ν•λ©΄ μ›λ³Έ κ°μ²΄λ” nullμ΄ λλ‹¤.  